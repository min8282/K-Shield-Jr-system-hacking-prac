/*
    gcc -Wall -fno-stack-protector -no-pie -Wl,-z,now rop.c -o rop
*/

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#pragma GCC diagnostic ignored "-Wstringop-overflow"

void gadget() {
  __asm__ (
    "pop %rdi\n\t"
    "pop %rsi\n\t"
    "pop %rdx\n\t"
    "ret\n\t"
  );
}

void init() {
  setvbuf(stdin, 0, 2, 0);
  setvbuf(stdout, 0, 2, 0);
  setvbuf(stderr, 0, 2, 0);
}

void vuln() {
  char buf[0x40] = { 0, };
  read(0, buf, 0x100);
  write(1, buf, 0x40);
}

int main() {
  init();
  vuln();
  return 0;
}